from scipy.special import binom

def main():
    compress_cipher = [0x43, 0x26, 0xc7, 0x31, 0x59, 0xe8, 0x9d, 0x09, 0x29, 0x7a, 0xe5, 0x24, 0xa6, 0x22, 0x1a]
    start = [0x47, 0x48, 0x31, 0x39, 0x7b]
    start_encrypted = [0xc5, 0x5b, 0xfc, 0x43, 0x88]
    for x in range(len(compress_cipher)):
        start_encrypted.append(new_byte([start_encrypted[i+x] for i in range(5)], compress_cipher[x]))
    print(decrypt(start_encrypted))
#    print(start_encrypted)
#    print(len(start_encrypted))
#    print(len(compress_cipher))

def new_byte(l, f_c):
    ret = f_c
    for k in range(len(l)):
        ret -= l[k]*int(binom(5, k))
    return ret%256

def decrypt(l):
    chiff_1 = [0x80, 0x00, 0x40, 0x80, 0x00, 0x40, 0x80, 0x00, 0x40, 0x80, 0x00, 0x40, 0x80, 0x00, 0x40, 0x80, 0x00, 0x40, 0x80, 0x00, 0x40]
    chiff_2 = [0x45, 0x4c, 0x46, 0x45, 0x4c, 0x46, 0x45, 0x4c, 0x46, 0x45, 0x4c, 0x46, 0x45, 0x4c, 0x46, 0x45, 0x4c, 0x46, 0x45, 0x4c, 0x46]

    tmp1 = [(x-y)%256 for x,y in zip(l,chiff_2)]
    tmp2 = [x^0x7f for x in tmp1]
    tmp3 = [(x+y)%256 for x,y in zip(tmp2, chiff_1)]
    tmp4 = [x^0x38 for x in tmp3]

    return [chr(x) for x in tmp4]

main()


