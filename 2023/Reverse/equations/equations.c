#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>


int main(int argc, char *argv[]) {
    bool valid = true;
    char *flag,
         *encrypted_flag = "\xc3\xc1IZ\xea\xd1\xcb\xe7\x61T\xce\x34\xfbjz\xbc:\r\xf4\xbf\x83\xe2\xf3`\x01";
    if (argc != 2) {
        fprintf(stderr, "Use %s <flag>\n", argv[0]);
        exit(1);
    }
    flag = argv[1];
    // Verify flag length
    valid &= (strlen(flag) == 25);
    // Ugly matrix multiplication
    valid &= (char)(229 * flag[0] + 43 * flag[1] + 177 * flag[2] + 215 * flag[3] + 47 * flag[4] + 251 * flag[5] + 245 * flag[6] + 31 * flag[7] + 7 * flag[8] + 191 * flag[9] + 119 * flag[10] + 227 * flag[11] + 33 * flag[12] + 251 * flag[13] + 159 * flag[14] + 107 * flag[15] + 241 * flag[16] + 111 * flag[17] + 79 * flag[18] + 217 * flag[19] + 7 * flag[20] + 119 * flag[21] + 221 * flag[22] + 253 * flag[23] + 45 * flag[24]) == encrypted_flag[0];
    valid &= (char)(143 * flag[0] + 64 * flag[1] + 112 * flag[2] + 202 * flag[3] + 124 * flag[4] + 92 * flag[5] + 120 * flag[6] + 236 * flag[7] + 72 * flag[8] + 18 * flag[9] + 22 * flag[10] + 126 * flag[11] + 72 * flag[12] + 78 * flag[13] + 28 * flag[14] + 24 * flag[15] + 6 * flag[16] + 184 * flag[17] + 34 * flag[18] + 134 * flag[19] + 240 * flag[20] + 190 * flag[21] + 190 * flag[22] + 198 * flag[23] + 80 * flag[24]) == encrypted_flag[1];
    valid &= (char)(67 * flag[0] + 26 * flag[1] + 213 * flag[2] + 223 * flag[3] + 145 * flag[4] + 185 * flag[5] + 199 * flag[6] + 181 * flag[7] + 97 * flag[8] + 141 * flag[9] + 207 * flag[10] + 245 * flag[11] + 33 * flag[12] + 109 * flag[13] + 71 * flag[14] + 59 * flag[15] + 13 * flag[16] + 81 * flag[17] + 189 * flag[18] + 171 * flag[19] + 137 * flag[20] + 111 * flag[21] + 45 * flag[22] + 39 * flag[23] + 221 * flag[24]) == encrypted_flag[2];
    valid &= (char)(105 * flag[0] + 74 * flag[1] + 187 * flag[2] + 60 * flag[3] + 44 * flag[4] + 2 * flag[5] + 178 * flag[6] + 160 * flag[7] + 198 * flag[8] + 190 * flag[9] + 160 * flag[10] + 166 * flag[11] + 118 * flag[12] + 2 * flag[13] + 136 * flag[14] + 62 * flag[15] + 114 * flag[16] + 14 * flag[17] + 66 * flag[18] + 48 * flag[19] + 202 * flag[20] + 78 * flag[21] + 170 * flag[22] + 208 * flag[23] + 252 * flag[24]) == encrypted_flag[3];
    valid &= (char)(245 * flag[0] + 88 * flag[1] + 123 * flag[2] + 122 * flag[3] + 219 * flag[4] + 165 * flag[5] + 25 * flag[6] + 193 * flag[7] + 15 * flag[8] + 221 * flag[9] + 147 * flag[10] + 199 * flag[11] + 31 * flag[12] + 153 * flag[13] + 155 * flag[14] + 7 * flag[15] + 81 * flag[16] + 103 * flag[17] + 251 * flag[18] + 243 * flag[19] + 209 * flag[20] + 73 * flag[21] + 183 * flag[22] + 11 * flag[23] + 15 * flag[24]) == encrypted_flag[4];
    valid &= (char)(21 * flag[0] + 68 * flag[1] + 29 * flag[2] + 232 * flag[3] + 219 * flag[4] + 38 * flag[5] + 62 * flag[6] + 52 * flag[7] + 124 * flag[8] + 210 * flag[9] + 88 * flag[10] + 84 * flag[11] + 52 * flag[12] + 238 * flag[13] + 144 * flag[14] + 218 * flag[15] + 114 * flag[16] + 46 * flag[17] + 138 * flag[18] + 22 * flag[19] + 72 * flag[20] + 254 * flag[21] + 222 * flag[22] + 146 * flag[23] + 186 * flag[24]) == encrypted_flag[5];
    valid &= (char)(175 * flag[0] + 220 * flag[1] + 9 * flag[2] + 102 * flag[3] + 13 * flag[4] + 214 * flag[5] + 179 * flag[6] + 103 * flag[7] + 11 * flag[8] + 99 * flag[9] + 113 * flag[10] + 1 * flag[11] + 45 * flag[12] + 61 * flag[13] + 27 * flag[14] + 67 * flag[15] + 5 * flag[16] + 15 * flag[17] + 53 * flag[18] + 251 * flag[19] + 43 * flag[20] + 1 * flag[21] + 195 * flag[22] + 23 * flag[23] + 251 * flag[24]) == encrypted_flag[6];
    valid &= (char)(223 * flag[0] + 86 * flag[1] + 189 * flag[2] + 76 * flag[3] + 59 * flag[4] + 82 * flag[5] + 137 * flag[6] + 78 * flag[7] + 16 * flag[8] + 32 * flag[9] + 212 * flag[10] + 48 * flag[11] + 238 * flag[12] + 64 * flag[13] + 68 * flag[14] + 198 * flag[15] + 252 * flag[16] + 28 * flag[17] + 8 * flag[18] + 200 * flag[19] + 64 * flag[20] + 226 * flag[21] + 24 * flag[22] + 30 * flag[23] + 78 * flag[24]) == encrypted_flag[7];
    valid &= (char)(103 * flag[0] + 178 * flag[1] + 157 * flag[2] + 78 * flag[3] + 195 * flag[4] + 48 * flag[5] + 61 * flag[6] + 140 * flag[7] + 11 * flag[8] + 177 * flag[9] + 43 * flag[10] + 75 * flag[11] + 107 * flag[12] + 61 * flag[13] + 173 * flag[14] + 91 * flag[15] + 69 * flag[16] + 119 * flag[17] + 75 * flag[18] + 249 * flag[19] + 101 * flag[20] + 57 * flag[21] + 19 * flag[22] + 65 * flag[23] + 9 * flag[24]) == encrypted_flag[8];
    valid &= (char)(93 * flag[0] + 194 * flag[1] + 93 * flag[2] + 74 * flag[3] + 187 * flag[4] + 220 * flag[5] + 217 * flag[6] + 48 * flag[7] + 209 * flag[8] + 6 * flag[9] + 106 * flag[10] + 30 * flag[11] + 192 * flag[12] + 70 * flag[13] + 216 * flag[14] + 128 * flag[15] + 6 * flag[16] + 158 * flag[17] + 38 * flag[18] + 190 * flag[19] + 234 * flag[20] + 28 * flag[21] + 70 * flag[22] + 102 * flag[23] + 194 * flag[24]) == encrypted_flag[9];
    valid &= (char)(131 * flag[0] + 88 * flag[1] + 83 * flag[2] + 78 * flag[3] + 181 * flag[4] + 150 * flag[5] + 243 * flag[6] + 200 * flag[7] + 223 * flag[8] + 2 * flag[9] + 93 * flag[10] + 35 * flag[11] + 215 * flag[12] + 241 * flag[13] + 193 * flag[14] + 237 * flag[15] + 241 * flag[16] + 255 * flag[17] + 231 * flag[18] + 105 * flag[19] + 99 * flag[20] + 211 * flag[21] + 179 * flag[22] + 63 * flag[23] + 91 * flag[24]) == encrypted_flag[10];
    valid &= (char)(225 * flag[0] + 144 * flag[1] + 13 * flag[2] + 218 * flag[3] + 67 * flag[4] + 246 * flag[5] + 123 * flag[6] + 80 * flag[7] + 125 * flag[8] + 98 * flag[9] + 29 * flag[10] + 14 * flag[11] + 244 * flag[12] + 164 * flag[13] + 166 * flag[14] + 196 * flag[15] + 66 * flag[16] + 16 * flag[17] + 30 * flag[18] + 70 * flag[19] + 226 * flag[20] + 214 * flag[21] + 14 * flag[22] + 84 * flag[23] + 214 * flag[24]) == encrypted_flag[11];
    valid &= (char)(131 * flag[0] + 240 * flag[1] + 49 * flag[2] + 120 * flag[3] + 115 * flag[4] + 4 * flag[5] + 107 * flag[6] + 14 * flag[7] + 111 * flag[8] + 84 * flag[9] + 237 * flag[10] + 182 * flag[11] + 137 * flag[12] + 161 * flag[13] + 19 * flag[14] + 253 * flag[15] + 215 * flag[16] + 155 * flag[17] + 127 * flag[18] + 3 * flag[19] + 81 * flag[20] + 253 * flag[21] + 115 * flag[22] + 99 * flag[23] + 185 * flag[24]) == encrypted_flag[12];
    valid &= (char)(115 * flag[0] + 98 * flag[1] + 135 * flag[2] + 192 * flag[3] + 233 * flag[4] + 28 * flag[5] + 105 * flag[6] + 56 * flag[7] + 195 * flag[8] + 238 * flag[9] + 31 * flag[10] + 88 * flag[11] + 199 * flag[12] + 68 * flag[13] + 100 * flag[14] + 58 * flag[15] + 8 * flag[16] + 218 * flag[17] + 194 * flag[18] + 90 * flag[19] + 172 * flag[20] + 202 * flag[21] + 190 * flag[22] + 214 * flag[23] + 128 * flag[24]) == encrypted_flag[13];
    valid &= (char)(9 * flag[0] + 198 * flag[1] + 17 * flag[2] + 132 * flag[3] + 165 * flag[4] + 182 * flag[5] + 221 * flag[6] + 98 * flag[7] + 165 * flag[8] + 212 * flag[9] + 97 * flag[10] + 116 * flag[11] + 227 * flag[12] + 18 * flag[13] + 103 * flag[14] + 147 * flag[15] + 135 * flag[16] + 89 * flag[17] + 111 * flag[18] + 59 * flag[19] + 129 * flag[20] + 85 * flag[21] + 237 * flag[22] + 47 * flag[23] + 87 * flag[24]) == encrypted_flag[14];
    valid &= (char)(103 * flag[0] + 20 * flag[1] + 91 * flag[2] + 18 * flag[3] + 217 * flag[4] + 4 * flag[5] + 103 * flag[6] + 250 * flag[7] + 35 * flag[8] + 208 * flag[9] + 127 * flag[10] + 130 * flag[11] + 165 * flag[12] + 64 * flag[13] + 61 * flag[14] + 66 * flag[15] + 218 * flag[16] + 228 * flag[17] + 94 * flag[18] + 144 * flag[19] + 52 * flag[20] + 220 * flag[21] + 118 * flag[22] + 196 * flag[23] + 156 * flag[24]) == encrypted_flag[15];
    valid &= (char)(85 * flag[0] + 234 * flag[1] + 45 * flag[2] + 170 * flag[3] + 227 * flag[4] + 162 * flag[5] + 13 * flag[6] + 252 * flag[7] + 237 * flag[8] + 86 * flag[9] + 129 * flag[10] + 118 * flag[11] + 43 * flag[12] + 146 * flag[13] + 115 * flag[14] + 180 * flag[15] + 243 * flag[16] + 93 * flag[17] + 233 * flag[18] + 231 * flag[19] + 211 * flag[20] + 59 * flag[21] + 89 * flag[22] + 117 * flag[23] + 223 * flag[24]) == encrypted_flag[16];
    valid &= (char)(63 * flag[0] + 100 * flag[1] + 137 * flag[2] + 112 * flag[3] + 109 * flag[4] + 178 * flag[5] + 197 * flag[6] + 242 * flag[7] + 31 * flag[8] + 22 * flag[9] + 139 * flag[10] + 28 * flag[11] + 47 * flag[12] + 50 * flag[13] + 85 * flag[14] + 220 * flag[15] + 189 * flag[16] + 18 * flag[17] + 26 * flag[18] + 24 * flag[19] + 190 * flag[20] + 48 * flag[21] + 244 * flag[22] + 228 * flag[23] + 82 * flag[24]) == encrypted_flag[17];
    valid &= (char)(99 * flag[0] + 100 * flag[1] + 61 * flag[2] + 124 * flag[3] + 135 * flag[4] + 106 * flag[5] + 171 * flag[6] + 136 * flag[7] + 81 * flag[8] + 68 * flag[9] + 49 * flag[10] + 238 * flag[11] + 1 * flag[12] + 152 * flag[13] + 129 * flag[14] + 238 * flag[15] + 111 * flag[16] + 180 * flag[17] + 171 * flag[18] + 73 * flag[19] + 105 * flag[20] + 213 * flag[21] + 95 * flag[22] + 107 * flag[23] + 133 * flag[24]) == encrypted_flag[18];
    valid &= (char)(55 * flag[0] + 146 * flag[1] + 175 * flag[2] + 230 * flag[3] + 27 * flag[4] + 160 * flag[5] + 227 * flag[6] + 24 * flag[7] + 143 * flag[8] + 14 * flag[9] + 7 * flag[10] + 168 * flag[11] + 241 * flag[12] + 212 * flag[13] + 67 * flag[14] + 16 * flag[15] + 151 * flag[16] + 150 * flag[17] + 25 * flag[18] + 54 * flag[19] + 144 * flag[20] + 182 * flag[21] + 208 * flag[22] + 66 * flag[23] + 16 * flag[24]) == encrypted_flag[19];
    valid &= (char)(247 * flag[0] + 238 * flag[1] + 151 * flag[2] + 4 * flag[3] + 115 * flag[4] + 148 * flag[5] + 191 * flag[6] + 114 * flag[7] + 43 * flag[8] + 12 * flag[9] + 35 * flag[10] + 158 * flag[11] + 139 * flag[12] + 210 * flag[13] + 173 * flag[14] + 58 * flag[15] + 83 * flag[16] + 36 * flag[17] + 215 * flag[18] + 80 * flag[19] + 137 * flag[20] + 1 * flag[21] + 69 * flag[22] + 77 * flag[23] + 91 * flag[24]) == encrypted_flag[20];
    valid &= (char)(239 * flag[0] + 122 * flag[1] + 101 * flag[2] + 108 * flag[3] + 167 * flag[4] + 6 * flag[5] + 173 * flag[6] + 50 * flag[7] + 249 * flag[8] + 110 * flag[9] + 191 * flag[10] + 186 * flag[11] + 59 * flag[12] + 74 * flag[13] + 171 * flag[14] + 54 * flag[15] + 225 * flag[16] + 86 * flag[17] + 205 * flag[18] + 200 * flag[19] + 53 * flag[20] + 226 * flag[21] + 230 * flag[22] + 152 * flag[23] + 156 * flag[24]) == encrypted_flag[21];
    valid &= (char)(121 * flag[0] + 192 * flag[1] + 39 * flag[2] + 16 * flag[3] + 229 * flag[4] + 26 * flag[5] + 167 * flag[6] + 94 * flag[7] + 33 * flag[8] + 216 * flag[9] + 149 * flag[10] + 56 * flag[11] + 117 * flag[12] + 144 * flag[13] + 217 * flag[14] + 78 * flag[15] + 53 * flag[16] + 40 * flag[17] + 57 * flag[18] + 60 * flag[19] + 51 * flag[20] + 60 * flag[21] + 93 * flag[22] + 193 * flag[23] + 125 * flag[24]) == encrypted_flag[22];
    valid &= (char)(119 * flag[0] + 136 * flag[1] + 25 * flag[2] + 18 * flag[3] + 217 * flag[4] + 148 * flag[5] + 141 * flag[6] + 78 * flag[7] + 225 * flag[8] + 124 * flag[9] + 183 * flag[10] + 146 * flag[11] + 175 * flag[12] + 190 * flag[13] + 131 * flag[14] + 138 * flag[15] + 231 * flag[16] + 70 * flag[17] + 81 * flag[18] + 138 * flag[19] + 125 * flag[20] + 110 * flag[21] + 87 * flag[22] + 10 * flag[23] + 140 * flag[24]) == encrypted_flag[23];
    valid &= (char)(129 * flag[0] + 34 * flag[1] + 199 * flag[2] + 12 * flag[3] + 117 * flag[4] + 48 * flag[5] + 19 * flag[6] + 84 * flag[7] + 25 * flag[8] + 212 * flag[9] + 45 * flag[10] + 182 * flag[11] + 15 * flag[12] + 110 * flag[13] + 29 * flag[14] + 156 * flag[15] + 153 * flag[16] + 138 * flag[17] + 117 * flag[18] + 162 * flag[19] + 31 * flag[20] + 110 * flag[21] + 231 * flag[22] + 60 * flag[23] + 111 * flag[24]) == encrypted_flag[24];
    if (!valid) {
        fprintf(stderr, "Wrong flag, try again");
        exit(1);
    }
    puts("Well done ! You can validate the challenge with this flag");
    return 0;
}
